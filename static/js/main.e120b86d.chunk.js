(this["webpackJsonpray-shooting"]=this["webpackJsonpray-shooting"]||[]).push([[0],{11:function(t,e,n){},12:function(t,e,n){},14:function(t,e,n){"use strict";n.r(e);var r=n(1),i=n.n(r),l=n(5),h=n.n(l),s=(n(11),n(3)),u={NONE:0,CREATING_LINE_SEGMENT:1,SHOOTING_RAY:2},o=(n(12),n(6)),a=n(2);function c(t){return null===t?0:t.height}function f(t){return null===t?0:c(t.right)-c(t.left)}var g=function t(e,n,r,i){Object(a.a)(this,t),this.startX=e,this.startY=n,this.endX=r,this.endY=i};function p(t){this.element=t,this.height=1,this.left=null,this.right=null,this.id=Math.random()}function d(t){t.height=Math.max(c(t.left),c(t.right))+1}function v(t){var e=new p(t.element);return e.left=t.left,e.right=t.right,e.height=t.height,e.og=t,e}function m(t){if(null===t)return null;var e=v(t);return e.left=m(t.left),e.right=m(t.right),e}var y=function(){function t(e){Object(a.a)(this,t),this._compare="function"===typeof e?e:this.sortLeftToRight,this.current=null,this.versions=[],this.currVersionNum=0}return Object(o.a)(t,[{key:"sortLeftToRight",value:function(t,e){var n;if(void 0===t.endX&&void 0===t.endY)n=t.startX;else{if(this.currVersionNum<t.startX||this.currVersionNum>t.endX||this.currVersionNum<e.startX||this.currVersionNum>e.endX)throw console.log("OUT OF RANGE FUCK",this.currVersionNum,t,e),"Point not in range of line!";n=this.currVersionNum}var r=void 0===t.endX&&void 0===t.endY?t.startY:t.startY+(t.endY-t.startY)/(t.endX-t.startX)*(n-t.startX),i=e.startY+(e.endY-e.startY)/(e.endX-e.startX)*(n-e.startX);return r<i?-1:r>i?1:0}},{key:"step",value:function(){this.versions.push(this.current),this.currVersionNum+=1}},{key:"getVersion",value:function(t){return t<this.versions.length?this.versions[t]:null}},{key:"getSuccessor",value:function(t,e){var n=this._search(t,e),r=n.node,i=n.path;if(null===r||void 0===r)return null;if(r.right)return this.getMin(r.right);for(var l=i.length-2;l>=0;l--)if(i[l].left===i[l+1])return i[l];return null}},{key:"getPredecessor",value:function(t,e){var n=this._search(t,e),r=n.node,i=n.path;if(null===r||void 0===r)return null;if(r.left)return this.getMax(r.left);for(var l=i.length-2;l>=0;l--)if(i[l].right===i[l+1])return i[l];return null}},{key:"shootVerticalRay",value:function(t,e){e=new g(t,e);var n=this.getVersion(t);if(null===n)return null;var r=this._insert(e,n),i=this.getSuccessor(e,r);return null===i||i}},{key:"swap",value:function(t,e){var n=t.element;t.element=e.element,e.element=n}}]),t}();y.prototype.search=function(t){var e=this._search(t,this.current).node;return e?e.element:null},y.prototype._search=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(null===e||void 0===e)return{node:e,path:n};n.push(e);var r=this._compare(t,e.element);return r<0?this._search(t,e.left,n):r>0?this._search(t,e.right,n):{node:e,path:n}},y.prototype.insert=function(t){return console.log("inserting ",this.currVersionNum),console.log("before",this.currVersionNum,this.current),this.current=this._insert(t,this.current),console.log("after",this.currVersionNum,this.current),this.current},y.prototype._insert=function(t,e){if(null===e)return new p(t);e=v(e);var n=this._compare(t,e.element);n<0?e.left=this._insert(t,e.left):n>0&&(e.right=this._insert(t,e.right)),e.height=Math.max(c(e.left),c(e.right))+1;var r=f(e);if(r<-1){var i=this._compare(t,e.left.element);if(i<0)return m(this._rightRotate(e));if(i>0)return e.left=this._leftRotate(e.left),m(this._rightRotate(e))}else if(r>1){var l=this._compare(t,e.right.element);if(l>0)return m(this._leftRotate(e));if(l<0)return e.right=this._rightRotate(e.right),m(this._leftRotate(e))}return e},y.prototype._rightRotate=function(t){var e=t.left,n=e.right;return e.right=t,t.left=n,t.height=Math.max(c(t.left),c(t.right))+1,e.height=Math.max(c(e.left),c(e.right))+1,e},y.prototype._leftRotate=function(t){var e=t.right,n=e.left;return e.left=t,t.right=n,t.height=Math.max(c(t.left),c(t.right))+1,e.height=Math.max(c(e.left),c(e.right))+1,e},y.prototype.delete=function(t){null!==this.current&&(this.current=this._delete(t,this.current,null),console.log("AFTER DELETE: ",this.current))},y.prototype._delete=function(t,e,n){if(console.log("DELETE: ",this.currVersionNum,t,e,n),null===e)return null;var r=e;e=v(e);var i=this._compare(t,e.element);if(i<0)e.left&&0===this._compare(t,e.left.element)?this._delete(t,e.left,e):e.left=this._delete(t,e.left,e);else if(i>0)e.right&&0===this._compare(t,e.right.element)?this._delete(t,e.right,e):e.right=this._delete(t,e.right,e);else if(null!==e.left&&null!==e.right){var l=this._deleteMax(e.left,e);e.element=l.element}else if(null===e.left)if(null===e.right){if(null===n)return null;n.right===r?n.right=null:n.left=null}else{if(null===n)return e.right;n.right===r?n.right=e.right:n.left=e.right,e.right=null}else{if(null===n)return e.left;n.right===r?n.right=e.left:n.left=e.left,e.left=null}return this._balance(e,n)},y.prototype.deleteMax=function(){return this._deleteMax(this.current,null).element},y.prototype._deleteMax=function(t,e){var n;return console.log("DELETE_MAX:"),null===t.right?(n=this._delete(t.element,t,e),this._balance(t,e),n):(n=this._deleteMax(t.right,t),this._balance(t,e),n)},y.prototype.getMin=function(t){return null===t.left?t:this.getMin(t.left)},y.prototype.getMax=function(t){return null===t.right?t:this.getMax(t.right)},y.prototype._balance=function(t,e){console.log("Balance: ",this.current,this.currVersionNum,t,e),d(t=m(t));var n,r,i,l,h=f(t);return h<-1?(t=m(t),console.log("balance < -1"),l=t,i=t.left,r=this._getTallestSubtree(i),n=this._triNodeRestructure(r,i,l,e),d(l),d(r),d(i),d(l),d(r),d(i),n):h>1?(t=m(t),console.log("balance > 1"),l=t,i=t.right,r=this._getTallestSubtree(i),n=this._triNodeRestructure(r,i,l,e),d(l),d(r),d(i),d(l),d(r),d(i),n):(console.log("no balance needed"),d(t),t)},y.prototype._getTallestSubtree=function(t){return f(t)<0?t.left:t.right},y.prototype._triNodeRestructure=function(t,e,n,r){var i,l,h;return console.log("TRINODE: ",this.currVersionNum,t,e,n,r,this.current),n.right===e&&e.left===t&&(i=n,l=t,h=e),n.right===e&&e.right===t&&(i=n,l=e,h=t),n.left===e&&e.left===t&&(i=t,l=e,h=n),n.left===e&&e.right===t&&(i=e,l=t,h=n),n.og===this.current||n===this.current||n.element===this.current.element||null===r?this.current=l:r.left===n?r.left=l:r.right=l,l.left!==t&&l.left!==e&&l.left!==n&&(i.right=l.left),l.right!==t&&l.right!==e&&l.right!==n&&(h.left=l.right),l.left=i,l.right=h,l},y.prototype.forEach=function(t){this._forEach(this.current,t)},y.prototype._forEach=function(t,e){null!==t&&(this._forEach(t.left,e),e(t.element),this._forEach(t.right,e))},y.prototype.getElementsAtDepth=function(t){var e=[];return this._getElementsAtDepth(t,0,this.current,e),e},y.prototype._getElementsAtDepth=function(t,e,n,r){null!==n&&(t!==e?(this._getElementsAtDepth(t,e+1,n.left,r),this._getElementsAtDepth(t,e+1,n.right,r)):r.push(n.element))};var x={START:"start",END:"end",CROSS:"cross"},_=n.p+"static/media/plus.18e46bbf.svg",b=n.p+"static/media/ray.86b55e34.svg",E=n.p+"static/media/wrench.6be9f8c4.svg",N=function t(){var e=this;Object(a.a)(this,t),this.leftChild=function(t){return 2*t+1},this.rightChild=function(t){return 2*t+2},this.parent=function(t){return Math.floor((t-1)/2)},this.peek=function(){return e.heap[0]},this.swap=function(t,n){var r=e.heap[t];e.heap[t]=e.heap[n],e.heap[n]=r},this.insert=function(t){e.heap.push(t);for(var n=e.heap.length-1;0!==n&&e.heap[n].val<e.heap[e.parent(n)].val;)e.swap(n,e.parent(n)),n=e.parent(n)},this.extractMin=function(){var t=e.heap.shift();return e.heap.unshift(e.heap[e.heap.length-1]),e.heap.pop(),e.heapify(0),t},this.heapify=function(t){var n=e.leftChild(t),r=e.rightChild(t),i=t;n<e.heap.length&&e.heap[i].val>e.heap[n].val&&(i=n),r<e.heap.length&&e.heap[i].val>e.heap[r].val&&(i=r),i!==t&&(e.swap(i,t),e.heapify(i))},this.heap=[]},O=n(0),T=function(){var t=Object(r.useState)(u.CREATING_LINE_SEGMENT),e=Object(s.a)(t,2),n=e[0],i=e[1],l=Object(r.useState)(null),h=Object(s.a)(l,2),o=h[0],a=h[1],c=Object(r.useState)([]),f=Object(s.a)(c,2),p=f[0],d=f[1],v=Object(r.useState)(new y),T=Object(s.a)(v,2),j=T[0],w=T[1],R=Object(r.useRef)(null),S=function(t){if(0!==t.length){var e=new y,n=new N;t.forEach((function(t){n.insert({eventType:x.START,line:t,val:t.x1,shouldInsert:!0}),n.insert({eventType:x.END,line:t,val:t.x2})}));for(var r=function(t){if(void 0===n.peek()||n.peek().val>t)return e.step(),"continue";var r=n.extractMin();if(console.log(r),r.eventType===x.START){var i,l,h,s,u,o;r.shouldInsert?(h=r.line.x1,s=window.innerHeight-r.line.y1,u=r.line.x2,o=window.innerHeight-r.line.y2,i=new g(h,s,u,o),l=e.insert(i)):(h=r.line.startX,s=r.line.startY,u=r.line.endX,o=r.line.endY,i=r.line,l=e.current);var a=e.getSuccessor(i,l),c=e.getPredecessor(i,l),f=function(e){var r=e.element.startX,l=e.element.startY,a=e.element.endX,c=e.element.endY,f=function(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)},g=((h*o-s*u)*(r-a)-(h-u)*(r*c-l*a))/((h-u)*(l-c)-(s-o)*(r-a)),p=((h*o-s*u)*(l-c)-(s-o)*(r*c-l*a))/((h-u)*(l-c)-(s-o)*(r-a));g>t&&f({x:h,y:s},{x:g,y:p},{x:u,y:o})&&f({x:r,y:l},{x:g,y:p},{x:a,y:c})&&n.insert({eventType:x.CROSS,line1:i,line2:e.element,intX:g,intY:p,val:g-1})};null!==a&&f(a),null!==c&&f(c)}else if(r.eventType===x.END){var p=r.line,d=p.x1,v=p.y1,y=p.x2,_=p.y2,b=new g(d,window.innerHeight-v,y,window.innerHeight-_);e.delete(b)}else if(r.eventType===x.CROSS){var E=m(e.current),N=e._search(r.line1,E).node,O=e._search(r.line2,E).node;if(null===N||null===O)return e.step(),"continue";e.swap(N,O),e.current=E,n.insert({eventType:x.START,line:N.element,val:Math.ceil(r.intX),shouldInsert:!1}),n.insert({eventType:x.START,line:O.element,val:Math.ceil(r.intX),shouldInsert:!1})}e.step()},i=0;i<window.innerWidth;i+=1)r(i);return e}},M=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=document.createElementNS("http://www.w3.org/2000/svg","line");return n.setAttribute("x1",t.x1),n.setAttribute("y1",t.y1),n.setAttribute("x2",t.x2),n.setAttribute("y2",t.y2),null!==e&&n.setAttribute("id",e),n},C=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,r=document.createElementNS("http://www.w3.org/2000/svg","circle");return r.setAttribute("cx",t),r.setAttribute("cy",e),r.setAttribute("r",n),r};return Object(O.jsxs)("div",{className:"App",onClick:function(t){if("svg"===t.target.tagName.toLowerCase()&&n===u.CREATING_LINE_SEGMENT)if(null===o)a({x:t.clientX,y:t.clientY}),R.current.appendChild(C(t.clientX,t.clientY));else{a(null);var e=t.clientX<o.x,r={x1:e?t.clientX:o.x,y1:e?t.clientY:o.y,x2:e?o.x:t.clientX,y2:e?o.y:t.clientY};d(p.concat(r)),R.current.appendChild(M(r)),R.current.appendChild(C(t.clientX,t.clientY))}},children:[Object(O.jsx)("div",{className:"vertical-lines"}),Object(O.jsx)("div",{className:"horizontal-lines"}),Object(O.jsxs)("div",{className:"button-bar",children:[Object(O.jsxs)("button",{className:n===u.CREATING_LINE_SEGMENT?"selected":"",onClick:function(){return i(u.CREATING_LINE_SEGMENT)},children:[Object(O.jsx)("img",{src:_,alt:"Create line segment"}),Object(O.jsx)("p",{children:"Create line segment"})]}),Object(O.jsxs)("button",{className:n===u.SHOOTING_RAY?"selected":"",onClick:function(){0!==p.length&&(w(S(p)),i(u.SHOOTING_RAY))},children:[Object(O.jsx)("img",{src:b,alt:"Shoot vertical ray"}),Object(O.jsx)("p",{children:"Shoot vertical ray"})]}),Object(O.jsxs)("button",{onClick:function(){for(;R.current.firstChild;)R.current.removeChild(R.current.firstChild);var t=[{x1:100,y1:100,x2:300,y2:100},{x1:99,y1:100,x2:100,y2:150},{x1:101,y1:150,x2:299,y2:150},{x1:301,y1:100,x2:302,y2:150}];t.forEach((function(t){R.current.appendChild(M(t)),R.current.appendChild(C(t.x1,t.y1)),R.current.appendChild(C(t.x2,t.y2))})),d(t),w(S(t)),i(u.SHOOTING_RAY)},children:[Object(O.jsx)("img",{src:E,alt:"Create user interface"}),Object(O.jsx)("p",{children:"Create user interface"})]})]}),Object(O.jsx)("svg",{ref:R,width:window.innerWidth,height:window.innerHeight,onMouseMove:function(t){if(n===u.SHOOTING_RAY&&void 0!==j){null!==document.getElementById("ray")&&document.getElementById("ray").remove();var e=j.shootVerticalRay(t.clientX,window.innerHeight-t.clientY);if(null!==e&&void 0!==e.element){var r=e.element,i=r.startX,l=r.startY,h=r.endX,s=l+(r.endY-l)/(h-i)*(t.clientX-i);R.current.appendChild(M({x1:t.clientX,y1:t.clientY,x2:t.clientX,y2:window.innerHeight-s},"ray"))}}}})]})},j=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,15)).then((function(e){var n=e.getCLS,r=e.getFID,i=e.getFCP,l=e.getLCP,h=e.getTTFB;n(t),r(t),i(t),l(t),h(t)}))};h.a.render(Object(O.jsx)(i.a.StrictMode,{children:Object(O.jsx)(T,{})}),document.getElementById("root")),j()}},[[14,1,2]]]);
//# sourceMappingURL=main.e120b86d.chunk.js.map